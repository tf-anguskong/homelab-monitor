server {
    listen 80;

    # Public dashboard page
    location /public-dashboards/ {
        proxy_pass http://grafana:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Static assets (JS, CSS, fonts) required to render the dashboard
    location /public/ {
        proxy_pass http://grafana:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Public dashboard data API (panel queries, metadata)
    location /api/public/ {
        proxy_pass http://grafana:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Redirect root to the public dashboard
    location = / {
        return 301 /public-dashboards/24363f16b3124e059fb30a979341bb9e;
    }

    # Block everything else
    location / {
        return 403;
    }
}
